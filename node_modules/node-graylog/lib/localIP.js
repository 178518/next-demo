"use strict";
/**
* @Author: Zhengfeng.Yao <yzf>
* @Date:   2017-04-07 15:27:32
* @Last modified by:   yzf
* @Last modified time: 2017-04-07 15:27:34
*
* 获取本机IP，用于发往日志系统的source
*/
Object.defineProperty(exports, "__esModule", { value: true });
var os = require("os");
var _ = require("lodash");
var interfaces = os.networkInterfaces();
function getLocalIP() {
    if (interfaces) {
        var ipList_1 = [];
        _.values(interfaces).forEach(function (item) {
            ipList_1 = ipList_1.concat(item);
        });
        ipList_1 = ipList_1.filter(function (item) { return item.family === 'IPv4'; });
        if (ipList_1.length === 1) {
            return ipList_1[0].address;
        }
        var ip = ipList_1.find(function (item) { return item.address.startsWith('192.168.'); });
        if (!!ip) {
            return ip.address;
        }
        ip = ipList_1.find(function (item) { return item.address.startsWith('10.'); });
        if (!!ip) {
            return ip.address;
        }
        ip = ipList_1.find(function (item) { return item.address.startsWith('172.31.'); });
        if (!!ip) {
            return ip.address;
        }
        ip = ipList_1.find(function (item) { return item.address !== '127.0.0.1'; });
        if (!!ip) {
            return ip.address;
        }
        return ipList_1[0].address;
    }
    return '127.0.0.1';
}
exports.getLocalIP = getLocalIP;
var localIP = getLocalIP();
exports.default = localIP;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9jYWxJUC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9sb2NhbElQLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7OztFQU9FOztBQUVGLHVCQUF5QjtBQUN6QiwwQkFBNEI7QUFFNUIsSUFBTSxVQUFVLEdBQUcsRUFBRSxDQUFDLGlCQUFpQixFQUFFLENBQUM7QUFFMUM7SUFDRSxJQUFJLFVBQVUsRUFBRTtRQUNkLElBQUksUUFBTSxHQUE4QixFQUFFLENBQUM7UUFDM0MsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQSxJQUFJO1lBQy9CLFFBQU0sR0FBRyxRQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO1FBQ0gsUUFBTSxHQUFHLFFBQU0sQ0FBQyxNQUFNLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxJQUFJLENBQUMsTUFBTSxLQUFLLE1BQU0sRUFBdEIsQ0FBc0IsQ0FBQyxDQUFDO1FBQ3ZELElBQUksUUFBTSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDdkIsT0FBTyxRQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDO1NBQzFCO1FBQ0QsSUFBSSxFQUFFLEdBQUcsUUFBTSxDQUFDLElBQUksQ0FBQyxVQUFBLElBQUksSUFBSSxPQUFBLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFuQyxDQUFtQyxDQUFDLENBQUM7UUFDbEUsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFFO1lBQ1IsT0FBTyxFQUFFLENBQUMsT0FBTyxDQUFDO1NBQ25CO1FBQ0QsRUFBRSxHQUFHLFFBQU0sQ0FBQyxJQUFJLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsRUFBOUIsQ0FBOEIsQ0FBQyxDQUFDO1FBQ3pELElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBRTtZQUNSLE9BQU8sRUFBRSxDQUFDLE9BQU8sQ0FBQztTQUNuQjtRQUNELEVBQUUsR0FBRyxRQUFNLENBQUMsSUFBSSxDQUFDLFVBQUEsSUFBSSxJQUFJLE9BQUEsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLEVBQWxDLENBQWtDLENBQUMsQ0FBQztRQUM3RCxJQUFJLENBQUMsQ0FBQyxFQUFFLEVBQUU7WUFDUixPQUFPLEVBQUUsQ0FBQyxPQUFPLENBQUM7U0FDbkI7UUFDRCxFQUFFLEdBQUcsUUFBTSxDQUFDLElBQUksQ0FBQyxVQUFBLElBQUksSUFBSSxPQUFBLElBQUksQ0FBQyxPQUFPLEtBQUssV0FBVyxFQUE1QixDQUE0QixDQUFDLENBQUM7UUFDdkQsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFFO1lBQ1IsT0FBTyxFQUFFLENBQUMsT0FBTyxDQUFDO1NBQ25CO1FBRUQsT0FBTyxRQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDO0tBQzFCO0lBQ0QsT0FBTyxXQUFXLENBQUM7QUFDckIsQ0FBQztBQTlCRCxnQ0E4QkM7QUFFRCxJQUFNLE9BQU8sR0FBRyxVQUFVLEVBQUUsQ0FBQztBQUU3QixrQkFBZSxPQUFPLENBQUMifQ==